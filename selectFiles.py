import shutil
import os

datasetDetails = "/home/sparknode/IdeaProjects/DetectMalware/DatasetDetails.csv" 
datasetPath = "/media/sparknode/0552ca8f-5c83-439b-bdb7-5d88a272f2b5/Lab Machine Backup/Malware Data Collection/Data/Kaggle-microsoft-malware-data/train/train"
outputPath = "/home/sparknode/selected-input"

requiredFileName = {}

with open(datasetDetails, 'r') as fileNames:
	for name in fileNames:
		requiredFileName[name.split(",")[0]+".bytes"] = 1

for key in requiredFileName:
	print key


for root, dirs, files in os.walk(datasetPath):
	for file in files:
		if file.endswith(".bytes"):
			#print(os.path.join(root,file))
		#	print file
			if file in requiredFileName:
				shutil.copy2(os.path.join(root, file), outputPath)
