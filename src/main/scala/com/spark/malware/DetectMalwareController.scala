package com.spark.malware

import org.apache.spark._
/**
  * Created by sparknode on 11/11/16.
  */
object DetectMalwareController {

  // Create a Scala Spark Context.
  val sparkConf = new SparkConf().setMaster("local[*]").setAppName("DetectMalwareController")
  //val sparkConf = new SparkConf().setMaster("spark://10.176.149.136:7077").setSparkHome("/home/ram/Downloads/spark-2.0.1-bin-hadoop2.4").setAppName("DetectMalwareController")
  val sparkContext = new SparkContext(sparkConf)

  def main(args: Array[String]) {

    val inputFile = args(0)
    val outputFile = args(1)

    //Extract N-grams
    val ngrams_collection = ExtractFeatures.extractNgrams( inputFile )
    //Select Features
    val N_grams_pair = ngrams_collection.map( x=> ( x._1, x._2.split(":")(2) ))
    SelectFeatures.generateFeatureSet( N_grams_pair )
    //Build Training dataset
    //Generate feature set
    //Build Model
    //Build Testing dataset using Feature set and test data
    //Predict files
  }

}
