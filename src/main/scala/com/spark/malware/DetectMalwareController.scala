package com.spark.malware

/**
  * Created by ram on 11/11/16.
  */

object DetectMalwareController {


   def main(args: Array[String]) {

    val inputFile = args(0)
    val outputFile = args(1)

    //Extract N-grams
    val NgramsCollection = ExtractFeatures.extractNgrams( inputFile )

     //Select Features
     //extract (ngram, classLabel)
    val N_grams_pair = NgramsCollection.map( x=> ( x._1, x._2.split(Constants.SYMBOL_COLON)(2) ))
    SelectFeatures.generateFeatureSet( N_grams_pair )

    val featureVector = SelectFeatures.getFeatureSet()

    featureVector.saveAsTextFile("/home/sparknode/output")
     //Build Training dataset
    //Generate feature set
    //Build Model
    //Build Testing dataset using Feature set and test data
    //Predict files
  }

}
