package com.spark.malware

import org.apache.spark.rdd.RDD

/**
  * Created by ram on 11/23/16.
  */
object SelectFeatures {

  var selectionMethod = RunParameters.DEFAULT_FEATURE_SELECTION_METHOD

  def setMethod( method : String) = {
      this.selectionMethod = method
  }

  def generateFeatureSet( N_gram_records : RDD[(String, String)]) = {

    if(selectionMethod.equals(Constants.INFORMATION_GAIN) ) {
      val featureSet = selectUsingInformationGain( N_gram_records )
    }
    else if(selectionMethod.equals(Constants.PRINCIPAL_COMPONENT_ANALYSIS) ) {

    }
    else if(selectionMethod.equals(Constants.SINGULAR_VALUE_DECOMPOSITION) ) {

    }

  }

  def selectUsingInformationGain( N_gram_records : RDD[(String, String)]) = {

    println("information Gain selected")

    val Ngram_class0 = N_gram_records.filter( x => x._2.equals(Constants.CLASS_ZERO)).map(x => (x._1, 1)).reduceByKey(_+_)
    val Ngram_class1 = N_gram_records.filter( x => x._2.equals(Constants.CLASS_ONE)).map(x => (x._1, 1)).reduceByKey(_+_)

    //Ngram_class0.join(Ngram_class1).map()
    val total_class0_files = 50
    val total_class1_files = 50

    Ngram_class0.foreach(println)
    Ngram_class1.foreach(println)

  }

  def getFeatureSet() = {

  }
}
